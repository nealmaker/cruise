---
title: "Bassage-Hanna Property"
author: "Forest Management Plan"
date: "`r lubridate::today()`"
output:
  tufte::tufte_handout: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, error = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3.75)
```

```{r wrangling_cruise, include=FALSE}
property <- "bassage-s"
year <- 2019

load(file = paste("C:/Users/Neal/projects/cruise/rda/", property, "-cruise-", year, ".rda", sep = ""))

library(tidyverse)
library(ggthemes)
library(stargazer)
library(knitr)
library(extrafont)
loadfonts("win", quiet = TRUE)
```

```{r pbf_logo, fig.margin=TRUE, out.width='30%', out.height='30%', fig.align='center'}
knitr::include_graphics("C:/Users/Neal/projects/cruise/logo-small.png")
```

\begin{marginfigure}
\noindent \textit{\large Prepared by} 
\newline\indent Neal F. Maker and John D. Foppert  
\newline\indent Pekin Branch Forestry  
\newline\indent 1324 West County Road  
\newline\indent Calais, VT 05648  
\newline\indent (802) 229-9757  
\end{marginfigure}

\begin{marginfigure}
\noindent \textit{\large Owner}
\newline\indent `r owners`  
\newline\indent `r addressline1`
`r ifelse(is.na(addressline2), "", "\n")`\indent `r if_else(is.na(addressline2), "", addressline2)`
\newline\indent `r citystatezip`  
\end{marginfigure}

\begin{marginfigure}
\noindent \textit{\large Property}   
\newline\indent `r paste(glacres, "acres", gldescrip, sep = " ")`   
\newline\indent `r paste(town, ", VT", sep = "")`  
\newline\indent SPAN `r span`  
\newline\indent Map delineation based on VMP  
\newline\indent Photo(s) `r photo`  
\end{marginfigure}

\begin{marginfigure}
\noindent \textit{\large Effective date of plan}  
\newline\indent April 1, `r if_else(month < 4, year, year+1)`  
\end{marginfigure}

\vspace{30pt}
\indent This forest management plan is a blueprint for responsible land stewardship.  It is the result of a planning process that incorporated an assessment of the history and current conditions on the property, consideration of the various courses of future development that the forest could follow, and discernment as to which outcomes best suit my particular objectives.

\vspace{5pt}
By signing below, I certify that I approve of---and agree to manage my forestland according to---the following management plan. I further certify that any of my forestland that is enrolled in Vermont's Use Value Appraisal program is under active long-term forest management in accordance with the state's minimum acceptable standards for forest management. These standards include following Acceptable Management Practices to maintain water quality on logging operations.  

\vspace{38pt}

\noindent\rule{9cm}{0.4pt} \rule{.3cm}{0pt} \rule{4cm}{0.4pt}  

\noindent Landowner \rule{7.7cm}{0pt} Date						

\vspace{18pt}

\noindent\rule{9cm}{0.4pt} \rule{.3cm}{0pt} \rule{4cm}{0.4pt}  

\noindent Landowner \rule{7.7cm}{0pt} Date	 

\vspace{18pt}

\noindent\rule{9cm}{0.4pt} \rule{.3cm}{0pt} \rule{4cm}{0.4pt}  

\noindent Landowner \rule{7.7cm}{0pt} Date	 

\vspace{18pt}

\noindent\rule{9cm}{0.4pt} \rule{.3cm}{0pt} \rule{4cm}{0.4pt}  

\noindent Landowner \rule{7.7cm}{0pt} Date  

\vspace{24pt}

This forest management plan meets the standards promulgated by the Vermont Department of Forests, Parks and Recreation as required for eligibility in the Use Value Appraisal Program.  

\vspace{22pt}

\noindent\rule{9cm}{0.4pt} \rule{.3cm}{0pt} \rule{4cm}{0.4pt}  

\noindent County Forester \rule{7cm}{0pt} Date

\pagebreak

#Introduction

This plan covers the ten year period from `r if_else(month < 4, year, year+1)` to `r if_else(month < 4, year+9, year+10)`. It lays out the near- and medium-term actions that should guide the development of the `r forestname` Forest.  It also qualifies portions of the property for Use Value Appraisal (UVA) and commensurate reduction in property taxes.^[Further information about UVA and current valuations can be found at the Vermont Tax Department's website: https://tax.vermont.gov/property-owners/current-use. \vspace{20pt}]  Owners participating in the Use Value Appraisal program are obliged to manage enrolled portions of their property according to the plan and to make any reasonable investments for improvement that the plan recommends.^[UVA management plan standards are determined by the Department of Forests, Parks, & Recreation and are available at https://fpr.vermont.gov/forest/managing-your-woodlands/use-value-appraisal or through a County Forester.]  Its recommendations were developed in accordance with the principles and practices of scientifically sound forestry, as described in the relevant management guidelines, textbooks and academic journals.

#Property Description

`r if_else(sum(stands$acres_legal) == glacres, "All", paste("Some", round(100*sum(stands$acres_legal)/glacres), "percent", sep = " "))` of the `r glacres` acre `r forestname` property is productive forestland that will be managed according to this plan. Its elevations range from `r elevationmin` to `r elevationmax` feet above mean sea level. `r watertext` `r boundariestext` 

Wildlife habitat is discussed in some detail in the next section, and soils, forest health, and other pertinent topics are discussed in the individual stand area descriptions that follow.

#Landscape Context and Habitat

The property is located in the Northern Vermont Piedmont biophysical region, which is characterized by gently rolling topography, a pattern of small villages surrounded by sparsely settled residential and agricultural areas, rich soils, and an agrarian legacy that is largely responsible for the composition and structure of today's forests. Its agricultural history left a fairly widespread network of roads across the region and large blocks of unbroken forest are now uncommon.  A dense network of streams, ponds, and wetlands is also present, and together with the diverse forests and remaining fields, it supports many different animal species. 

The `r forestname` property is located in a more densely settled area that extends north from Montpelier along the Kingsbury Branch of the Winooski River. This fragmented forest is not as useful for far-ranging, interior wildlife species like moose and great horned owls, but it does support many species that thrive on "edge" habitat or that have smaller home ranges. Water courses are especially important in this setting, because they often serve as migration corridors for animals and plants. For that reason, the state has identified the stream and wetlands on the `r forestname` property as "highest priority surface water and riparian areas," and as "riparian wildlife connectivity" areas.

Also, while the property's underlying bedrock and the resulting calcareous soils are not uncommon in Vermont, they are uncommon elsewhere, and the state considers them a priority for conservation. By protecting these areas from development and fragmentation, the natural communities that are defined by them can be protected as well. The property's cedar forest (Area 3) is especially notable in this regard. Cedar is tolerant of a wide range of moisture regimes, but it prefers calcium rich soils. Hillside cedar forests like the one on the `r forestname` property are uncommon because they depend on calcareous soils and specific patterns of ground water flow. 

Like most parts of the state, Calais is dominated by middle-aged forests.  Its history of clearing and abandonment eliminated large trees in most places and simplified forest structures.  The resulting young woods were generally less susceptible to disturbances such as windthrow, and humans have mostly followed a path of low intensity, exploitative logging in recent years, limiting tree regeneration.  While many species are undeterred by these simplified conditions, others are affected.  Bats that once relied on the shaggy bark of old trees for their roosts are forced to find other arrangements, cavity dwelling species lack large dead and dying cavity trees, and the dearth of vertical structure limits the diversity of songbirds, which are able to differentiate into numerous specific niches in multi-aged forests. 

```{r drawing1, fig.margin=TRUE, out.width='100%', out.height='100%', fig.align='center'}
knitr::include_graphics("C:/Users/Neal/projects/cruise/mixed-selection.png")
```

The `r forestname` forest has greater structure and more cavity trees than many forests nearby, but there is plenty of room for improvement. Area 5--in the south--seems to support an especially diverse mixture of wildlife species, because it has a component of older pasture trees that are intermixed with areas of dense regeneration. It also has a great diversity of site conditions and tree species, and some down woody material from wind-thrown trees. Deer, coyote, weasel, and hare tracks were observed here during the inventory, along with several abandoned porcupine dens and porcupine feeding sites. Hermit and wood thrushes, black-throated blue and black-throated green warblers, and hairy and pileated woodpeckers are probably at home in the stand too; and a variety of amphibians likely live in and around wetter areas, especially where there is down woody material nearby to provide overwintering areas. 

Other stands with simpler structures and fewer tree species don't support the same wildlife diversity on their own, but in combination they contribute to landscape-level, "horizontal" diversity. For instance, fewer animals make regular use of the dense, even-aged, monotypic cedar forest; but it provides valuable winter cover for deer, grouse, and others because it is in close proximity to other habitats where those animals can find food and water. The `r forestname` property has dense softwood forests, more open hardwood and mixedwood forests, young forests, wetlands, and open field: all within a quarter mile of one another.

Young, shrubby forests with low cover are especially lacking in the region, as most fields are mowed regularly and canopy gaps in the woods are rare. There are a few small areas of young forest on the `r forestname` property, where windthrow has made canopy openings in Area 5 and in one younger part of Area 7. The abandoned upper beaver pond is beginning to serve the purpose too, as it slowly dries out and develops shrub cover. These areas support many small mammals that need the low cover for protection from predators; and a host of songbirds, like chestnut-sided warblers, white-throated and song sparrows, and common yellowthroats.

#Principles, Goals & Strategies For Forest Management

```{r drawing2, fig.margin=TRUE, out.width='100%', out.height='100%', fig.align='center'}
knitr::include_graphics("C:/Users/Neal/projects/cruise/maple.png")
```

`r paste(objectives)`

\begin{marginfigure}
\noindent \textit{\LARGE Management Schedule}
\vspace{10pt}

\noindent \textit{\large 2022}

\begin{itemize}
  \item Area 6: Thinning from below 
\end{itemize}

\vspace{10pt}  
\noindent \textit{\large `r if_else(month < 4, year+9, year+10)`}  

\begin{itemize}
  \item Reinventory property
\end{itemize}
\end{marginfigure}

#Stand Descriptions & Management Recommendations

Presented below are detailed stand-by-stand descriptions of the forest, the long-term structural, compositional and functional goals for each stand, and the near-term silvicultural treatments or management activities that have been prescribed to advance each stand toward those goals.  The data presented in the following pages was obtained from a field examination of the property in `r lubridate::month(month, label = TRUE, abbr = FALSE)` of `r year`.  General conditions were assessed qualitatively in conjunction with quantitative sampling.  Observational notes and sample summary statistics together provide the basis for the area descriptions and management recommendations. All sampling was done using a systematic sample and variable radius plots. In stands with uneven-aged structures, all trees 6" in diameter at breast height (dbh) and larger were measured in each plot. In stands with even-aged structures, all main-canopy trees were measured in each plot.

When contractors are used to implement silvicultural prescriptions, they should be highly skilled, properly equipped, fully insured, and closely supervised.  A professional forester should prepare and administer commercial treatments, and logging operations should be timed to coincide with favorable weather conditions (working on wet soils only when they are frozen, for instance) and favorable timber markets.  Use Value Appraisal program guidelines allow any management activities prescribed in this plan to be carried out up to three years before or after the date indicated.  Landowners in the Use Value Appraisal program must file a Forest Management Activity Report with the County Forester by February 1^st^ if any commercial logging occurred in the previous year. 

The property should be reinventoried in `r if_else(month < 4, year+9, year+10)` and the findings brought to bear on a reassessment of the goals and strategies proposed in this plan, leading to a formal management plan update.  At any point over the course of this management period, this plan may be updated to incorporate new information and to reflect any new thoughts, concerns or considerations on the part of the owners or the foresters helping to manage their land.

\newpage

```{r set1}
std <- 1
```

#Area `r std` 
`r (stands %>% filter(stand == std))$type`    
\noindent `r sprintf("%.2f", (stands %>% filter(stand == std))$acres_legal)` legal acres | `r sprintf("%.2f", (stands %>% filter(stand == std))$acres_calc)` measured acres    

##Site-specific information

> - __Soils:__   
\indent\indent `r paste((soils %>% filter(stand == std))$text, collapse = " ") %>% str_replace_all("START", "\n") %>% str_replace_all("END", "  ")` 

> - __Site Class:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$site_class` (determined from soil mapping and field assessment)   

> - __Access:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$access` 

> - __Stand history:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$history` 

##Current forest information

> - __Age Class Structure:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$structure.1`  
```{r diam_dist1, fig.margin=TRUE, fig.width=2, fig.height=6, fig.cap="Distributions are approximated with kernel density estimation. Common species are those that account for at least 8 percent of the total stocking and areas under each curve represent species basal areas."}

# diameter dist of main spp in a specific stand ----

trees %>% filter(stand == std, live == 1, dbh >= 6) %>%
  group_by(spp) %>%
  mutate(spp_sum = sum(live)) %>%
  ungroup() %>%
  mutate(spp = reorder(spp, -live, FUN = sum)) %>%
  filter(spp_sum/n()>=.08) %>% 
  ggplot(aes(dbh, y = ..count..)) +
  geom_density(alpha = .6, position = "identity", fill = "grey", col = "dark grey") +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "none") +
  facet_wrap(~spp, ncol = 1) +
  scale_y_continuous("relative basal area", labels = NULL, 
                     breaks = NULL) +
  scale_x_continuous("dbh") +
  labs(title = "Diameter distributions", 
       subtitle = "for common species")
```

```{r spp1}
x <- trees %>% 
  filter(stand == std, live == 1, dbh >= 6) %>% 
  group_by(spp) %>% 
  summarize(spp_sum = sum(live)) %>%
  mutate(pct = spp_sum / sum(spp_sum)) %>%
  select(spp, pct) %>%
  arrange(-pct)
```

> - __Species (% stocking):__   
\vspace{2pt}
`r if_else(nrow(x)>0, paste(x$spp, " (", round(x$pct*100), '%)', sep = '', collapse = ", "), "none")`  

> - __Regeneration:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$regen`  

> - __Forest health:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$health`  

> - __Volume/ac:__   
\vspace{2pt}
`r round(stands %>% filter(stand == std) %>% .$veneer_vol/1000,1)` MBF veneer, `r round(stands %>% filter(stand == std) %>% .$saw_vol/1000,1)` MBF sawtimber, `r round(stands %>% filter(stand == std) %>% .$tie_vol/1000,1)` MBF tie logs,   
`r round(stands %>% filter(stand == std) %>% .$cord_vol)` cds pulp   

> - __Size class structure (%BA):__  	 
\vspace{2pt}
\indent 6-10”: `r round(sum(trees$stand == std & trees$dbh >= 6 & trees$dbh <= 10 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`% | 11-16”: `r round(sum(trees$stand == std & trees$dbh > 10 & trees$dbh <=16 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`%	| 17-22”: `r round(sum(trees$stand == std & trees$dbh > 16 & trees$dbh <= 22 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`% |	23+”: `r round(sum(trees$stand == std & trees$dbh > 22 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`%  

> - __Standing dead wood:__    
\vspace{2pt}
`r round((plots %>% filter(stand == std) %>% summarize(snagba = mean(ba_snags)))$snagba[1])` ft^2^/acre; `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = mean(dbh)))$snagd[1])`\" mean dbh (ranging from `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = min(dbh)))$snagd[1])`\" to `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = max(dbh)))$snagd[1])`\")

##Inventory information

> - `r stands %>% filter(stand == std) %>% .$plots` points, `r baf` BAF, `r paste(lubridate::month(month, label = TRUE, abbr = FALSE), year, sep = ", ")`

```{r stockingchart1, fig.cap="Points represent individual plots. Asterisk represnts stand average. Radial lines are quadratic stand diameters.", echo=FALSE, results='hide'}
this_stand <- stands %>%
  filter(stand == std)

# qsd lines --------------

dbhbold <- seq(2, 26, 2)
dbhlight <- seq(1, 25, 2)

# qsd labels -------------

dbhlabs <- paste(c(4,6,8,10,12,14,16,20), '"', sep = "")

dbhlabstop <- tibble(y = rep(max(this_stand$ay1, 
                             max((plots %>% 
                                    filter(stand == std))$ba_live))+5, 
                             times = 8)) %>% 
  mutate(x = y/(.005454*c(4,6,8,10,12,14,16,20)^2))

dbhlabsright <- tibble(x = rep(max(this_stand$ax2,
                                   max((plots %>%
                                          filter(stand == std))$tpa_live))+50,
                               times = 8))
dbhlabsright <- dbhlabsright %>%
  mutate(y = x*.005454*c(4,6,8,10,12,14,16,20)^2)

# plot with a b & c curves -----------

curveplot <- plots %>% filter(stand == std) %>%
  ggplot(aes(tpa_live, ba_live)) +
  geom_abline(slope = .005454*dbhbold^2, col = "dark gray") +
  geom_abline(slope = .005454*dbhlight^2, col = "gray") +
  annotate("text", x = dbhlabstop$x, 
           y = dbhlabstop$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  annotate("text", x = dbhlabsright$x, 
           y = dbhlabsright$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  geom_curve(aes(x = this_stand$ax1,
                 y = this_stand$ay1,
                 xend = this_stand$ax2,
                 yend = this_stand$ay2),
             curvature = this_stand$acurv,
             angle = this_stand$aangle) + 
  geom_curve(aes(x = this_stand$bx1,
                 y = this_stand$by1,
                 xend = this_stand$bx2,
                 yend = this_stand$by2),
             curvature = this_stand$bcurv,
             angle = this_stand$bangle) + 
  geom_curve(aes(x = this_stand$cx1,
                 y = this_stand$cy1,
                 xend = this_stand$cx2,
                 yend = this_stand$cy2),
             curvature = this_stand$ccurv,
             angle = this_stand$cangle) +
  geom_text(aes(this_stand$ax2, 
                this_stand$ay2, 
                label = this_stand$alab),
            nudge_x = this_stand$anudge,
            family = "Perpetua") +
  geom_text(aes(this_stand$bx2, 
                this_stand$by2, 
                label = this_stand$blab),
            nudge_x = this_stand$bnudge,
            family = "Perpetua") +
  geom_text(aes(this_stand$cx2, 
                this_stand$cy2, 
                label = this_stand$clab),
            nudge_x = this_stand$cnudge,
            family = "Perpetua") +
  geom_point() +
  geom_point(aes(this_stand$tpa, 
                 this_stand$mean_ba),
             size = 3, 
             shape = 8, 
             stroke = 1.5) +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "right") +
  scale_x_continuous(name = "trees per acre",
                     limits = c(min(this_stand$cx1, 
                                    min((plots %>% 
                                           filter(stand == std))$tpa_live)),
                                max(this_stand$ax2,
                                    max((plots %>% 
                                           filter(stand == std))$tpa_live))+50)) +
  scale_y_continuous(name = "basal area per acre (sq ft)",
                     limits = c(min(this_stand$cy2, 
                                    min((plots %>% 
                                           filter(stand == std))$ba_live)),
                                max(this_stand$ay1,
                                    max((plots %>% 
                                           filter(stand == std))$ba_live))+5)) +
  labs(title = "Stocking chart",
       caption = paste("Reproduced from ", this_stand$name, 
                       " stocking guide: ", this_stand$author,
                       ". ", this_stand$source, sep = ""))

# plot w/o curves -----------------

dbhlabstop <- tibble(y = rep(max((plots %>% 
                                    filter(stand == std))$ba_live)+20, 
                             times = 8)) %>% 
  mutate(x = y/(.005454*c(4,6,8,10,12,14,16,20)^2))

dbhlabsright <- tibble(x = rep(max((plots %>%
                                          filter(stand == std))$tpa_live)+100,
                               times = 8)) %>%
  mutate(y = x*.005454*c(4,6,8,10,12,14,16,20)^2)
  
curvelessplot <- plots %>% filter(stand == std) %>%
  ggplot(aes(tpa_live, ba_live)) +
  geom_abline(slope = .005454*dbhbold^2, col = "dark gray") +
  geom_abline(slope = .005454*dbhlight^2, col = "gray") +
  annotate("text", x = dbhlabstop$x, 
           y = dbhlabstop$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  annotate("text", x = dbhlabsright$x, 
           y = dbhlabsright$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  geom_point() +
  geom_point(aes(this_stand$tpa, 
                 this_stand$mean_ba),
             size = 3, 
             shape = 8, 
             stroke = 1.5) +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "right") +
  scale_x_continuous(name = "trees per acre",
                     limits = c(min((plots %>% 
                                           filter(stand == std))$tpa_live)-100,
                                max((plots %>% 
                                           filter(stand == std))$tpa_live)+100)) +
  scale_y_continuous(name = "basal area per acre (sq ft)",
                     limits = c(min((plots %>% 
                                           filter(stand == std))$ba_live)-20,
                                max((plots %>% 
                                           filter(stand == std))$ba_live)+20)) +
  labs(title = "Stocking chart")

ifelse(this_stand$structure.1[1] == "Even-aged", print(curveplot),
       print(curvelessplot))
```

##Long-term management system

**Even-aged management**^[Leak, W.B., M.Yamasaki, and R. Holleran. 2014. Silvicultural Guide for Northern Hardwoods in the Northeast. USDA For. Serv. Gen. Tech. Rep. NRS-132.]      
This area should be treated as an even-aged stand and grown another 20 years or so before it is regenerated (we believe most trees are about 80 to 100 now). Different strategies can be explored at that time for overcoming the beech, ferns, and deer. A reassessment should be made in ten years to determine if the stand should be thinned one more time before regeneration. 

##Silvicultural prescription

No work needs to happen over the next decade, as the stocking is still close to b-line. The owners may wish to cut firewood for their own use. Removals should be limited to a couple of cords per year from unacceptable growing stock. Healthy looking, mature beech trees should not be removed. They are an important source of food for many species, and are uncommon on the property.

```{r ags_ugs_table1, results="asis"}
temp1 <- stands %>% filter(stand == std)
temp2 <- c(temp1$mean_ba, temp1$qsd, temp1$tpa)
temp3 <- c(temp1$ba_ags, temp1$qsd_ags, temp1$tpa_ags)
temp4 <- c(temp1$ba_inv, temp1$qsd_in, temp1$tpa_inv)
temp0 <- c('Basal area (sqft/ac)', 'QSD (in)', 'Stems/ac')
temp5 <- data.frame(temp0, temp2, temp3, temp4)

kable(temp5, digits = 0, col.names = c(' ', 'Total', 'Acceptable', 'Investment-grade'), caption = "Measures of stocking for all live trees (total), acceptable growing stock, and investment-grade growing stock (which is a subset of acceptable growing stock).")
```

\newpage

```{r set2}
std <- 2
```

#Area `r std` 
`r (stands %>% filter(stand == std))$type`    
\noindent `r sprintf("%.2f", (stands %>% filter(stand == std))$acres_legal)` legal acres | `r sprintf("%.2f", (stands %>% filter(stand == std))$acres_calc)` measured acres    

##Site-specific information

> - __Soils:__   
\indent\indent `r paste((soils %>% filter(stand == std))$text, collapse = " ") %>% str_replace_all("START", "\n") %>% str_replace_all("END", "  ")` 

> - __Site Class:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$site_class` (determined from soil mapping and field assessment)   

> - __Access:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$access` 

> - __Stand history:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$history` 

##Current forest information

> - __Age Class Structure:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$structure.1`  
```{r diam_dist2, fig.margin=TRUE, fig.width=2, fig.height=6, fig.cap="Distributions are approximated with kernel density estimation. Common species are those that account for at least 8 percent of the total stocking and areas under each curve represent species basal areas."}

# diameter dist of main spp in a specific stand ----

trees %>% filter(stand == std, live == 1, dbh >= 6) %>%
  group_by(spp) %>%
  mutate(spp_sum = sum(live)) %>%
  ungroup() %>%
  mutate(spp = reorder(spp, -live, FUN = sum)) %>%
  filter(spp_sum/n()>=.08) %>% 
  ggplot(aes(dbh, y = ..count..)) +
  geom_density(alpha = .6, position = "identity", fill = "grey", col = "dark grey") +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "none") +
  facet_wrap(~spp, ncol = 1) +
  scale_y_continuous("relative basal area", labels = NULL, 
                     breaks = NULL) +
  scale_x_continuous("dbh") +
  labs(title = "Diameter distributions", 
       subtitle = "for common species")
```

```{r spp2}
x <- trees %>% 
  filter(stand == std, live == 1, dbh >= 6) %>% 
  group_by(spp) %>% 
  summarize(spp_sum = sum(live)) %>%
  mutate(pct = spp_sum / sum(spp_sum)) %>%
  select(spp, pct) %>%
  arrange(-pct)
```

> - __Species (% stocking):__   
\vspace{2pt}
`r if_else(nrow(x)>0, paste(x$spp, " (", round(x$pct*100), '%)', sep = '', collapse = ", "), "none")`  

> - __Regeneration:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$regen`  

> - __Forest health:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$health`  

> - __Volume/ac:__   
\vspace{2pt}
`r round(stands %>% filter(stand == std) %>% .$veneer_vol/1000,1)` MBF veneer, `r round(stands %>% filter(stand == std) %>% .$saw_vol/1000,1)` MBF sawtimber, `r round(stands %>% filter(stand == std) %>% .$tie_vol/1000,1)` MBF tie logs,   
`r round(stands %>% filter(stand == std) %>% .$cord_vol)` cds pulp   

> - __Size class structure (%BA):__  	 
\vspace{2pt}
\indent 6-10”: `r round(sum(trees$stand == std & trees$dbh >= 6 & trees$dbh <= 10 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`% | 11-16”: `r round(sum(trees$stand == std & trees$dbh > 10 & trees$dbh <=16 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`%	| 17-22”: `r round(sum(trees$stand == std & trees$dbh > 16 & trees$dbh <= 22 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`% |	23+”: `r round(sum(trees$stand == std & trees$dbh > 22 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`%  

> - __Standing dead wood:__    
\vspace{2pt}
`r round((plots %>% filter(stand == std) %>% summarize(snagba = mean(ba_snags)))$snagba[1])` ft^2^/acre; `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = mean(dbh)))$snagd[1])`\" mean dbh (ranging from `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = min(dbh)))$snagd[1])`\" to `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = max(dbh)))$snagd[1])`\")

##Inventory information

> - `r stands %>% filter(stand == std) %>% .$plots` points, `r baf` BAF, `r paste(lubridate::month(month, label = TRUE, abbr = FALSE), year, sep = ", ")`

```{r stockingchart2, fig.cap="Points represent individual plots. Asterisk represnts stand average. Radial lines are quadratic stand diameters.", echo=FALSE, results='hide'}
this_stand <- stands %>%
  filter(stand == std)

# qsd lines --------------

dbhbold <- seq(2, 26, 2)
dbhlight <- seq(1, 25, 2)

# qsd labels -------------

dbhlabs <- paste(c(4,6,8,10,12,14,16,20), '"', sep = "")

dbhlabstop <- tibble(y = rep(max(this_stand$ay1, 
                             max((plots %>% 
                                    filter(stand == std))$ba_live))+5, 
                             times = 8)) %>% 
  mutate(x = y/(.005454*c(4,6,8,10,12,14,16,20)^2))

dbhlabsright <- tibble(x = rep(max(this_stand$ax2,
                                   max((plots %>%
                                          filter(stand == std))$tpa_live))+50,
                               times = 8))
dbhlabsright <- dbhlabsright %>%
  mutate(y = x*.005454*c(4,6,8,10,12,14,16,20)^2)

# plot with a b & c curves -----------

curveplot <- plots %>% filter(stand == std) %>%
  ggplot(aes(tpa_live, ba_live)) +
  geom_abline(slope = .005454*dbhbold^2, col = "dark gray") +
  geom_abline(slope = .005454*dbhlight^2, col = "gray") +
  annotate("text", x = dbhlabstop$x, 
           y = dbhlabstop$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  annotate("text", x = dbhlabsright$x, 
           y = dbhlabsright$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  geom_curve(aes(x = this_stand$ax1,
                 y = this_stand$ay1,
                 xend = this_stand$ax2,
                 yend = this_stand$ay2),
             curvature = this_stand$acurv,
             angle = this_stand$aangle) + 
  geom_curve(aes(x = this_stand$bx1,
                 y = this_stand$by1,
                 xend = this_stand$bx2,
                 yend = this_stand$by2),
             curvature = this_stand$bcurv,
             angle = this_stand$bangle) + 
  geom_curve(aes(x = this_stand$cx1,
                 y = this_stand$cy1,
                 xend = this_stand$cx2,
                 yend = this_stand$cy2),
             curvature = this_stand$ccurv,
             angle = this_stand$cangle) +
  geom_text(aes(this_stand$ax2, 
                this_stand$ay2, 
                label = this_stand$alab),
            nudge_x = this_stand$anudge,
            family = "Perpetua") +
  geom_text(aes(this_stand$bx2, 
                this_stand$by2, 
                label = this_stand$blab),
            nudge_x = this_stand$bnudge,
            family = "Perpetua") +
  geom_text(aes(this_stand$cx2, 
                this_stand$cy2, 
                label = this_stand$clab),
            nudge_x = this_stand$cnudge,
            family = "Perpetua") +
  geom_point() +
  geom_point(aes(this_stand$tpa, 
                 this_stand$mean_ba),
             size = 3, 
             shape = 8, 
             stroke = 1.5) +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "right") +
  scale_x_continuous(name = "trees per acre",
                     limits = c(min(this_stand$cx1, 
                                    min((plots %>% 
                                           filter(stand == std))$tpa_live)),
                                max(this_stand$ax2,
                                    max((plots %>% 
                                           filter(stand == std))$tpa_live))+50)) +
  scale_y_continuous(name = "basal area per acre (sq ft)",
                     limits = c(min(this_stand$cy2, 
                                    min((plots %>% 
                                           filter(stand == std))$ba_live)),
                                max(this_stand$ay1,
                                    max((plots %>% 
                                           filter(stand == std))$ba_live))+5)) +
  labs(title = "Stocking chart",
       caption = paste("Reproduced from ", this_stand$name, 
                       " stocking guide: ", this_stand$author,
                       ". ", this_stand$source, sep = ""))

# plot w/o curves -----------------

dbhlabstop <- tibble(y = rep(max((plots %>% 
                                    filter(stand == std))$ba_live)+20, 
                             times = 8)) %>% 
  mutate(x = y/(.005454*c(4,6,8,10,12,14,16,20)^2))

dbhlabsright <- tibble(x = rep(max((plots %>%
                                          filter(stand == std))$tpa_live)+100,
                               times = 8)) %>%
  mutate(y = x*.005454*c(4,6,8,10,12,14,16,20)^2)
  
curvelessplot <- plots %>% filter(stand == std) %>%
  ggplot(aes(tpa_live, ba_live)) +
  geom_abline(slope = .005454*dbhbold^2, col = "dark gray") +
  geom_abline(slope = .005454*dbhlight^2, col = "gray") +
  annotate("text", x = dbhlabstop$x, 
           y = dbhlabstop$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  annotate("text", x = dbhlabsright$x, 
           y = dbhlabsright$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  geom_point() +
  geom_point(aes(this_stand$tpa, 
                 this_stand$mean_ba),
             size = 3, 
             shape = 8, 
             stroke = 1.5) +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "right") +
  scale_x_continuous(name = "trees per acre",
                     limits = c(min((plots %>% 
                                           filter(stand == std))$tpa_live)-100,
                                max((plots %>% 
                                           filter(stand == std))$tpa_live)+100)) +
  scale_y_continuous(name = "basal area per acre (sq ft)",
                     limits = c(min((plots %>% 
                                           filter(stand == std))$ba_live)-20,
                                max((plots %>% 
                                           filter(stand == std))$ba_live)+20)) +
  labs(title = "Stocking chart")

ifelse(this_stand$structure.1[1] == "Even-aged", print(curveplot),
       print(curvelessplot))
```

```{r ags_ugs_table2, results="asis"}
temp1 <- stands %>% filter(stand == std)
temp2 <- c(temp1$mean_ba, temp1$qsd, temp1$tpa)
temp3 <- c(temp1$ba_ags, temp1$qsd_ags, temp1$tpa_ags)
temp4 <- c(temp1$ba_inv, temp1$qsd_in, temp1$tpa_inv)
temp0 <- c('Basal area (sqft/ac)', 'QSD (in)', 'Stems/ac')
temp5 <- data.frame(temp0, temp2, temp3, temp4)

kable(temp5, digits = 0, col.names = c(' ', 'Total', 'Acceptable', 'Investment-grade'), caption = "Measures of stocking for all live trees (total), acceptable growing stock, and investment-grade growing stock (which is a subset of acceptable growing stock).")
```

##Long-term management system

**Even-aged management**^[Leak, W.B., M.Yamasaki, and R. Holleran. 2014. Silvicultural Guide for Northern Hardwoods in the Northeast. USDA For. Serv. Gen. Tech. Rep. NRS-132.]      
This area should be maintained as an even-aged stand and grown to an age of about 120 before it is regenerated (we believe it's about 75 now). Regular tending, every 20 years or so, should focus growth on the highest quality stems and favor desirable species; namely sugar maple, yellow birch, red maple, and spruce. A component of hemlock should be kept too, for its longevity and contribution to wildlife habitat. 

The hemlock that is kept should be grown past the end of the rotation so that it has the opportunity to develop large boles and fissured bark. Older declining trees of other species should also be kept so that they will become snags and, eventually, down woody material. A small component of hemlock and other large trees will greatly improve the quality of wildlife habitat without affecting timber growth appreciably.

\newpage
An unconfirmed vernal pool is mapped in the southern part of the stand. The inventory was done in winter months, so it was not assessed. It should be visited in early spring to see if it supports breeding amphibian populations. If so, a buffer area should be established around the pool and protected from soil disturbance and heavy logging. Generally, machinery should be kept more than 100 feet from breeding pools, and no large canopy openings should be created within 600 feet. This will help to maintain the moist understory that salamanders and frogs rely on.

##Silvicultural prescription

No work is needed over the next decade, as the stocking accrues. The owners may wish to cut firewood for their own use. Removals should be limited to a handful of cords per year from unacceptable growing stock.

\newpage

```{r set3}
std <- 3
```

#Area `r std` 
`r (stands %>% filter(stand == std))$type`    
\noindent `r sprintf("%.2f", (stands %>% filter(stand == std))$acres_legal)` legal acres | `r sprintf("%.2f", (stands %>% filter(stand == std))$acres_calc)` measured acres    

##Site-specific information

> - __Soils:__   
\indent\indent `r paste((soils %>% filter(stand == std))$text, collapse = " ") %>% str_replace_all("START", "\n") %>% str_replace_all("END", "  ")` 

> - __Site Class:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$site_class` (determined from soil mapping and field assessment)   

> - __Access:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$access` 

> - __Stand history:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$history` 

##Current forest information

> - __Age Class Structure:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$structure.1`  
```{r diam_dist3, fig.margin=TRUE, fig.width=2, fig.height=6, fig.cap="Distributions are approximated with kernel density estimation. Common species are those that account for at least 8 percent of the total stocking and areas under each curve represent species basal areas."}

# diameter dist of main spp in a specific stand ----

trees %>% filter(stand == std, live == 1, dbh >= 6) %>%
  group_by(spp) %>%
  mutate(spp_sum = sum(live)) %>%
  ungroup() %>%
  mutate(spp = reorder(spp, -live, FUN = sum)) %>%
  filter(spp_sum/n()>=.07) %>% 
  ggplot(aes(dbh, y = ..count..)) +
  geom_density(alpha = .6, position = "identity", fill = "grey", col = "dark grey") +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "none") +
  facet_wrap(~spp, ncol = 1) +
  scale_y_continuous("relative basal area", labels = NULL, 
                     breaks = NULL) +
  scale_x_continuous("dbh") +
  labs(title = "Diameter distributions", 
       subtitle = "for common species")
```

```{r spp3}
x <- trees %>% 
  filter(stand == std, live == 1, dbh >= 6) %>% 
  group_by(spp) %>% 
  summarize(spp_sum = sum(live)) %>%
  mutate(pct = spp_sum / sum(spp_sum)) %>%
  select(spp, pct) %>%
  arrange(-pct)
```

> - __Species (% stocking):__   
\vspace{2pt}
`r if_else(nrow(x)>0, paste(x$spp, " (", round(x$pct*100), '%)', sep = '', collapse = ", "), "none")`  

> - __Regeneration:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$regen`  

> - __Forest health:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$health`  

> - __Volume/ac:__   
\vspace{2pt}
`r round(stands %>% filter(stand == std) %>% .$veneer_vol/1000,1)` MBF veneer, `r round(stands %>% filter(stand == std) %>% .$saw_vol/1000,1)` MBF sawtimber, `r round(stands %>% filter(stand == std) %>% .$tie_vol/1000,1)` MBF tie logs,   
`r round(stands %>% filter(stand == std) %>% .$cord_vol)` cds pulp   

> - __Size class structure (%BA):__  	 
\vspace{2pt}
\indent 6-10”: `r round(sum(trees$stand == std & trees$dbh >= 6 & trees$dbh <= 10 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`% | 11-16”: `r round(sum(trees$stand == std & trees$dbh > 10 & trees$dbh <=16 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`%	| 17-22”: `r round(sum(trees$stand == std & trees$dbh > 16 & trees$dbh <= 22 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`% |	23+”: `r round(sum(trees$stand == std & trees$dbh > 22 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`%  

> - __Standing dead wood:__    
\vspace{2pt}
`r round((plots %>% filter(stand == std) %>% summarize(snagba = mean(ba_snags)))$snagba[1])` ft^2^/acre; `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = mean(dbh)))$snagd[1])`\" mean dbh (ranging from `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = min(dbh)))$snagd[1])`\" to `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = max(dbh)))$snagd[1])`\")

##Inventory information

> - `r stands %>% filter(stand == std) %>% .$plots` points, `r baf` BAF, `r paste(lubridate::month(month, label = TRUE, abbr = FALSE), year, sep = ", ")`

```{r stockingchart3, fig.cap="Points represent individual plots. Asterisk represnts stand average. Radial lines are quadratic stand diameters.", echo=FALSE, results='hide'}
this_stand <- stands %>%
  filter(stand == std)

# qsd lines --------------

dbhbold <- seq(2, 26, 2)
dbhlight <- seq(1, 25, 2)

# qsd labels -------------

dbhlabs <- paste(c(4,6,8,10,12,14,16,20), '"', sep = "")

dbhlabstop <- tibble(y = rep(max(this_stand$ay1, 
                             max((plots %>% 
                                    filter(stand == std))$ba_live))+5, 
                             times = 8)) %>% 
  mutate(x = y/(.005454*c(4,6,8,10,12,14,16,20)^2))

dbhlabsright <- tibble(x = rep(max(this_stand$ax2,
                                   max((plots %>%
                                          filter(stand == std))$tpa_live))+50,
                               times = 8))
dbhlabsright <- dbhlabsright %>%
  mutate(y = x*.005454*c(4,6,8,10,12,14,16,20)^2)

# plot with a b & c curves -----------

curveplot <- plots %>% filter(stand == std) %>%
  ggplot(aes(tpa_live, ba_live)) +
  geom_abline(slope = .005454*dbhbold^2, col = "dark gray") +
  geom_abline(slope = .005454*dbhlight^2, col = "gray") +
  annotate("text", x = dbhlabstop$x, 
           y = dbhlabstop$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  annotate("text", x = dbhlabsright$x, 
           y = dbhlabsright$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  geom_curve(aes(x = this_stand$ax1,
                 y = this_stand$ay1,
                 xend = this_stand$ax2,
                 yend = this_stand$ay2),
             curvature = this_stand$acurv,
             angle = this_stand$aangle) + 
  geom_curve(aes(x = this_stand$bx1,
                 y = this_stand$by1,
                 xend = this_stand$bx2,
                 yend = this_stand$by2),
             curvature = this_stand$bcurv,
             angle = this_stand$bangle) + 
  geom_curve(aes(x = this_stand$cx1,
                 y = this_stand$cy1,
                 xend = this_stand$cx2,
                 yend = this_stand$cy2),
             curvature = this_stand$ccurv,
             angle = this_stand$cangle) +
  geom_text(aes(this_stand$ax2, 
                this_stand$ay2, 
                label = this_stand$alab),
            nudge_x = this_stand$anudge,
            family = "Perpetua") +
  geom_text(aes(this_stand$bx2, 
                this_stand$by2, 
                label = this_stand$blab),
            nudge_x = this_stand$bnudge,
            family = "Perpetua") +
  geom_text(aes(this_stand$cx2, 
                this_stand$cy2, 
                label = this_stand$clab),
            nudge_x = this_stand$cnudge,
            family = "Perpetua") +
  geom_point() +
  geom_point(aes(this_stand$tpa, 
                 this_stand$mean_ba),
             size = 3, 
             shape = 8, 
             stroke = 1.5) +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "right") +
  scale_x_continuous(name = "trees per acre",
                     limits = c(min(this_stand$cx1, 
                                    min((plots %>% 
                                           filter(stand == std))$tpa_live)),
                                max(this_stand$ax2,
                                    max((plots %>% 
                                           filter(stand == std))$tpa_live))+50)) +
  scale_y_continuous(name = "basal area per acre (sq ft)",
                     limits = c(min(this_stand$cy2, 
                                    min((plots %>% 
                                           filter(stand == std))$ba_live)),
                                max(this_stand$ay1,
                                    max((plots %>% 
                                           filter(stand == std))$ba_live))+5)) +
  labs(title = "Stocking chart",
       caption = paste("Reproduced from ", this_stand$name, 
                       " stocking guide: ", this_stand$author,
                       ". ", this_stand$source, sep = ""))

# plot w/o curves -----------------

dbhlabstop <- tibble(y = rep(max((plots %>% 
                                    filter(stand == std))$ba_live)+20, 
                             times = 8)) %>% 
  mutate(x = y/(.005454*c(4,6,8,10,12,14,16,20)^2))

dbhlabsright <- tibble(x = rep(max((plots %>%
                                          filter(stand == std))$tpa_live)+100,
                               times = 8)) %>%
  mutate(y = x*.005454*c(4,6,8,10,12,14,16,20)^2)
  
curvelessplot <- plots %>% filter(stand == std) %>%
  ggplot(aes(tpa_live, ba_live)) +
  geom_abline(slope = .005454*dbhbold^2, col = "dark gray") +
  geom_abline(slope = .005454*dbhlight^2, col = "gray") +
  annotate("text", x = dbhlabstop$x, 
           y = dbhlabstop$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  annotate("text", x = dbhlabsright$x, 
           y = dbhlabsright$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  geom_point() +
  geom_point(aes(this_stand$tpa, 
                 this_stand$mean_ba),
             size = 3, 
             shape = 8, 
             stroke = 1.5) +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "right") +
  scale_x_continuous(name = "trees per acre",
                     limits = c(min((plots %>% 
                                           filter(stand == std))$tpa_live)-100,
                                max((plots %>% 
                                           filter(stand == std))$tpa_live)+100)) +
  scale_y_continuous(name = "basal area per acre (sq ft)",
                     limits = c(min((plots %>% 
                                           filter(stand == std))$ba_live)-20,
                                max((plots %>% 
                                           filter(stand == std))$ba_live)+20)) +
  labs(title = "Stocking chart")

ifelse(this_stand$structure.1[1] == "Even-aged", print(curveplot),
       print(curvelessplot))
```

```{r ags_ugs_table3, results="asis"}
temp1 <- stands %>% filter(stand == std)
temp2 <- c(temp1$mean_ba, temp1$qsd, temp1$tpa)
temp3 <- c(temp1$ba_ags, temp1$qsd_ags, temp1$tpa_ags)
temp4 <- c(temp1$ba_inv, temp1$qsd_in, temp1$tpa_inv)
temp0 <- c('Basal area (sqft/ac)', 'QSD (in)', 'Stems/ac')
temp5 <- data.frame(temp0, temp2, temp3, temp4)

kable(temp5, digits = 0, col.names = c(' ', 'Total', 'Acceptable', 'Investment-grade'), caption = "Measures of stocking for all live trees (total), acceptable growing stock, and investment-grade growing stock (which is a subset of acceptable growing stock).")
```

##Long-term management system

**Even-aged management**^[Hofmeyer et al. 2009. Northern white cedar ecology and silviculture in the Northeastern United States and southeastern Canada: a synthesis of knowledge. North. J. Appl. For. 26(1): pp. 21-27.]      
Cedar forests like this one are ecologically valuable, but can be very difficult to perpetuate. It is unclear if this stand is solely the result of pasture abandonment (second growth cedar has been observed colonizing abandoned pastures in Quebec, but often reverts to different species mixtures) or if cedar is naturally competative on the site. Either way, relatively high deer browse pressure would probably prohibit cedar regeneration if the canopy was opened. 

\newpage

The area should be maintained as an even-aged stand to keep the cedar canopy intact. It should be grown to an age of about 150 before it is regenerated, but that is subject to change based on observed growth rates and regeneration prospects. Regular tending, every 20 years or so, should focus growth on the highest quality stems while maintaining a relatively dense canopy. Area-wide thinning will probably be more successful here than in saturated cedar swamps on peat soils, because of the ground water movement. Great care should be taken to prevent damage to residual trees, however, as cedar have very low wood strength and can be damaged easily. 

##Silvicultural prescription

No logging needs to happen this decade, but an intermediate thinning should be planned for early in the next management cycle. If a good opportunity comes up before then (a careful, low impact logger available during a cold winter when the ground is well frozen) the thinning can be done sooner. A plan amendment would need to be filed with the County Forester before work was started.

\newpage

```{r set4}
std <- 4
```

#Area `r std` 
`r (stands %>% filter(stand == std))$type`    
\noindent `r sprintf("%.2f", (stands %>% filter(stand == std))$acres_legal)` legal acres | `r sprintf("%.2f", (stands %>% filter(stand == std))$acres_calc)` measured acres    

##Site-specific information

> - __Soils:__   
\indent\indent `r paste((soils %>% filter(stand == std))$text, collapse = " ") %>% str_replace_all("START", "\n") %>% str_replace_all("END", "  ")` 

> - __Site Class:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$site_class` (determined from soil mapping and field assessment)   

> - __Access:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$access` 

> - __Stand history:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$history` 

##Current forest information

> - __Age Class Structure:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$structure.1`  
```{r diam_dist4, fig.margin=TRUE, fig.width=2, fig.height=6, fig.cap="Distributions are approximated with kernel density estimation. Common species are those that account for at least 8 percent of the total stocking and areas under each curve represent species basal areas."}

# diameter dist of main spp in a specific stand ----

trees %>% filter(stand == std, live == 1, dbh >= 6) %>%
  group_by(spp) %>%
  mutate(spp_sum = sum(live)) %>%
  ungroup() %>%
  mutate(spp = reorder(spp, -live, FUN = sum)) %>%
  filter(spp_sum/n()>=.08) %>% 
  ggplot(aes(dbh, y = ..count..)) +
  geom_density(alpha = .6, position = "identity", fill = "grey", col = "dark grey") +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "none") +
  facet_wrap(~spp, ncol = 1) +
  scale_y_continuous("relative basal area", labels = NULL, 
                     breaks = NULL) +
  scale_x_continuous("dbh") +
  labs(title = "Diameter distributions", 
       subtitle = "for common species")
```

```{r spp4}
x <- trees %>% 
  filter(stand == std, live == 1, dbh >= 6) %>% 
  group_by(spp) %>% 
  summarize(spp_sum = sum(live)) %>%
  mutate(pct = spp_sum / sum(spp_sum)) %>%
  select(spp, pct) %>%
  arrange(-pct)
```

> - __Species (% stocking):__   
\vspace{2pt}
`r if_else(nrow(x)>0, paste(x$spp, " (", round(x$pct*100), '%)', sep = '', collapse = ", "), "none")`  

> - __Regeneration:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$regen`  

> - __Forest health:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$health`  

> - __Volume/ac:__   
\vspace{2pt}
`r round(stands %>% filter(stand == std) %>% .$veneer_vol/1000,1)` MBF veneer, `r round(stands %>% filter(stand == std) %>% .$saw_vol/1000,1)` MBF sawtimber, `r round(stands %>% filter(stand == std) %>% .$tie_vol/1000,1)` MBF tie logs,   
`r round(stands %>% filter(stand == std) %>% .$cord_vol)` cds pulp   

> - __Size class structure (%BA):__  	 
\vspace{2pt}
\indent 6-10”: `r round(sum(trees$stand == std & trees$dbh >= 6 & trees$dbh <= 10 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`% | 11-16”: `r round(sum(trees$stand == std & trees$dbh > 10 & trees$dbh <=16 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`%	| 17-22”: `r round(sum(trees$stand == std & trees$dbh > 16 & trees$dbh <= 22 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`% |	23+”: `r round(sum(trees$stand == std & trees$dbh > 22 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`%  

> - __Standing dead wood:__    
\vspace{2pt}
`r round((plots %>% filter(stand == std) %>% summarize(snagba = mean(ba_snags)))$snagba[1])` ft^2^/acre; `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = mean(dbh)))$snagd[1])`\" mean dbh (ranging from `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = min(dbh)))$snagd[1])`\" to `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = max(dbh)))$snagd[1])`\")

##Inventory information

> - `r stands %>% filter(stand == std) %>% .$plots` points, `r baf` BAF, `r paste(lubridate::month(month, label = TRUE, abbr = FALSE), year, sep = ", ")`

```{r stockingchart4, fig.cap="Points represent individual plots. Asterisk represnts stand average. Radial lines are quadratic stand diameters.", echo=FALSE, results='hide'}
this_stand <- stands %>%
  filter(stand == std)

# qsd lines --------------

dbhbold <- seq(2, 26, 2)
dbhlight <- seq(1, 25, 2)

# qsd labels -------------

dbhlabs <- paste(c(4,6,8,10,12,14,16,20), '"', sep = "")

dbhlabstop <- tibble(y = rep(max(this_stand$ay1, 
                             max((plots %>% 
                                    filter(stand == std))$ba_live))+5, 
                             times = 8)) %>% 
  mutate(x = y/(.005454*c(4,6,8,10,12,14,16,20)^2))

dbhlabsright <- tibble(x = rep(max(this_stand$ax2,
                                   max((plots %>%
                                          filter(stand == std))$tpa_live))+50,
                               times = 8))
dbhlabsright <- dbhlabsright %>%
  mutate(y = x*.005454*c(4,6,8,10,12,14,16,20)^2)

# plot with a b & c curves -----------

curveplot <- plots %>% filter(stand == std) %>%
  ggplot(aes(tpa_live, ba_live)) +
  geom_abline(slope = .005454*dbhbold^2, col = "dark gray") +
  geom_abline(slope = .005454*dbhlight^2, col = "gray") +
  annotate("text", x = dbhlabstop$x, 
           y = dbhlabstop$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  annotate("text", x = dbhlabsright$x, 
           y = dbhlabsright$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  geom_curve(aes(x = this_stand$ax1,
                 y = this_stand$ay1,
                 xend = this_stand$ax2,
                 yend = this_stand$ay2),
             curvature = this_stand$acurv,
             angle = this_stand$aangle) + 
  geom_curve(aes(x = this_stand$bx1,
                 y = this_stand$by1,
                 xend = this_stand$bx2,
                 yend = this_stand$by2),
             curvature = this_stand$bcurv,
             angle = this_stand$bangle) + 
  geom_curve(aes(x = this_stand$cx1,
                 y = this_stand$cy1,
                 xend = this_stand$cx2,
                 yend = this_stand$cy2),
             curvature = this_stand$ccurv,
             angle = this_stand$cangle) +
  geom_text(aes(this_stand$ax2, 
                this_stand$ay2, 
                label = this_stand$alab),
            nudge_x = this_stand$anudge,
            family = "Perpetua") +
  geom_text(aes(this_stand$bx2, 
                this_stand$by2, 
                label = this_stand$blab),
            nudge_x = this_stand$bnudge,
            family = "Perpetua") +
  geom_text(aes(this_stand$cx2, 
                this_stand$cy2, 
                label = this_stand$clab),
            nudge_x = this_stand$cnudge,
            family = "Perpetua") +
  geom_point() +
  geom_point(aes(this_stand$tpa, 
                 this_stand$mean_ba),
             size = 3, 
             shape = 8, 
             stroke = 1.5) +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "right") +
  scale_x_continuous(name = "trees per acre",
                     limits = c(min(this_stand$cx1, 
                                    min((plots %>% 
                                           filter(stand == std))$tpa_live)),
                                max(this_stand$ax2,
                                    max((plots %>% 
                                           filter(stand == std))$tpa_live))+50)) +
  scale_y_continuous(name = "basal area per acre (sq ft)",
                     limits = c(min(this_stand$cy2, 
                                    min((plots %>% 
                                           filter(stand == std))$ba_live)),
                                max(this_stand$ay1,
                                    max((plots %>% 
                                           filter(stand == std))$ba_live))+5)) +
  labs(title = "Stocking chart",
       caption = paste("Reproduced from ", this_stand$name, 
                       " stocking guide: ", this_stand$author,
                       ". ", this_stand$source, sep = ""))

# plot w/o curves -----------------

dbhlabstop <- tibble(y = rep(max((plots %>% 
                                    filter(stand == std))$ba_live)+20, 
                             times = 8)) %>% 
  mutate(x = y/(.005454*c(4,6,8,10,12,14,16,20)^2))

dbhlabsright <- tibble(x = rep(max((plots %>%
                                          filter(stand == std))$tpa_live)+100,
                               times = 8)) %>%
  mutate(y = x*.005454*c(4,6,8,10,12,14,16,20)^2)
  
curvelessplot <- plots %>% filter(stand == std) %>%
  ggplot(aes(tpa_live, ba_live)) +
  geom_abline(slope = .005454*dbhbold^2, col = "dark gray") +
  geom_abline(slope = .005454*dbhlight^2, col = "gray") +
  annotate("text", x = dbhlabstop$x, 
           y = dbhlabstop$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  annotate("text", x = dbhlabsright$x, 
           y = dbhlabsright$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  geom_point() +
  geom_point(aes(this_stand$tpa, 
                 this_stand$mean_ba),
             size = 3, 
             shape = 8, 
             stroke = 1.5) +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "right") +
  scale_x_continuous(name = "trees per acre",
                     limits = c(min((plots %>% 
                                           filter(stand == std))$tpa_live)-100,
                                max((plots %>% 
                                           filter(stand == std))$tpa_live)+100)) +
  scale_y_continuous(name = "basal area per acre (sq ft)",
                     limits = c(min((plots %>% 
                                           filter(stand == std))$ba_live)-20,
                                max((plots %>% 
                                           filter(stand == std))$ba_live)+20)) +
  labs(title = "Stocking chart")

ifelse(this_stand$structure.1[1] == "Even-aged", print(curveplot),
       print(curvelessplot))
```

```{r ags_ugs_table4, results="asis"}
temp1 <- stands %>% filter(stand == std)
temp2 <- c(temp1$mean_ba, temp1$qsd, temp1$tpa)
temp3 <- c(temp1$ba_ags, temp1$qsd_ags, temp1$tpa_ags)
temp4 <- c(temp1$ba_inv, temp1$qsd_in, temp1$tpa_inv)
temp0 <- c('Basal area (sqft/ac)', 'QSD (in)', 'Stems/ac')
temp5 <- data.frame(temp0, temp2, temp3, temp4)

kable(temp5, digits = 0, col.names = c(' ', 'Total', 'Acceptable', 'Investment-grade'), caption = "Measures of stocking for all live trees (total), acceptable growing stock, and investment-grade growing stock (which is a subset of acceptable growing stock).")
```

##Long-term management system

**Even-aged management**^[Leak, W.B., M.Yamasaki, and R. Holleran. 2014. Silvicultural Guide for Northern Hardwoods in the Northeast. USDA For. Serv. Gen. Tech. Rep. NRS-132.]      
This area should be maintained as an even-aged stand and grown to an age of about 120 before it is regenerated (we believe most trees are about 80 now). Regular tending, every 20 years or so, should focus growth on the highest quality stems and favor desirable species; namely white pine, spruce, cedar, and sugar maple. A component of hemlock should be kept too, for its longevity and contribution to wildlife habitat. 

\newpage
Like in Area 2, the hemlock that is kept should be grown past the end of the rotation so that it has the opportunity to develop large boles and fissured bark. Older declining trees of other species should also be kept so that they will become snags and, eventually, downed woody material. A few of the pines may be kept and grown to large sizes as well: they tend to be taller, canopy-emergent trees, and they make wonderful perches for birds of prey. Their bark is also excellent for bat roosts after they die. Again, just a few large trees per acre can add great value for wildlife while leaving plenty of space to grow timber.

##Silvicultural prescription

No work is needed over the next decade, as the stocking accrues.

\newpage

```{r set5}
std <- 5
```

#Area `r std` 
`r (stands %>% filter(stand == std))$type`    
\noindent `r sprintf("%.2f", (stands %>% filter(stand == std))$acres_legal)` legal acres | `r sprintf("%.2f", (stands %>% filter(stand == std))$acres_calc)` measured acres    

##Site-specific information

> - __Soils:__   
\indent\indent `r paste((soils %>% filter(stand == std))$text, collapse = " ") %>% str_replace_all("START", "\n") %>% str_replace_all("END", "  ")` 

> - __Site Class:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$site_class` (determined from soil mapping and field assessment)   

> - __Access:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$access` 

> - __Stand history:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$history` 

##Current forest information

> - __Age Class Structure:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$structure.1`  
```{r diam_dist5, fig.margin=TRUE, fig.width=2, fig.height=6, fig.cap="Distributions are approximated with kernel density estimation. Common species are those that account for at least 8 percent of the total stocking and areas under each curve represent species basal areas."}

# diameter dist of main spp in a specific stand ----

trees %>% filter(stand == std, live == 1, dbh >= 6) %>%
  group_by(spp) %>%
  mutate(spp_sum = sum(live)) %>%
  ungroup() %>%
  mutate(spp = reorder(spp, -live, FUN = sum)) %>%
  filter(spp_sum/n()>=.08) %>% 
  ggplot(aes(dbh, y = ..count..)) +
  geom_density(alpha = .6, position = "identity", fill = "grey", col = "dark grey") +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "none") +
  facet_wrap(~spp, ncol = 1) +
  scale_y_continuous("relative basal area", labels = NULL, 
                     breaks = NULL) +
  scale_x_continuous("dbh") +
  labs(title = "Diameter distributions", 
       subtitle = "for common species")
```

```{r spp5}
x <- trees %>% 
  filter(stand == std, live == 1, dbh >= 6) %>% 
  group_by(spp) %>% 
  summarize(spp_sum = sum(live)) %>%
  mutate(pct = spp_sum / sum(spp_sum)) %>%
  select(spp, pct) %>%
  arrange(-pct)
```

> - __Species (% stocking):__   
\vspace{2pt}
`r if_else(nrow(x)>0, paste(x$spp, " (", round(x$pct*100), '%)', sep = '', collapse = ", "), "none")`  

> - __Regeneration:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$regen`  

> - __Forest health:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$health`  

> - __Volume/ac:__   
\vspace{2pt}
`r round(stands %>% filter(stand == std) %>% .$veneer_vol/1000,1)` MBF veneer, `r round(stands %>% filter(stand == std) %>% .$saw_vol/1000,1)` MBF sawtimber, `r round(stands %>% filter(stand == std) %>% .$tie_vol/1000,1)` MBF tie logs,   
`r round(stands %>% filter(stand == std) %>% .$cord_vol)` cds pulp   

> - __Size class structure (%BA):__  	 
\vspace{2pt}
\indent 6-10”: `r round(sum(trees$stand == std & trees$dbh >= 6 & trees$dbh <= 10 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`% | 11-16”: `r round(sum(trees$stand == std & trees$dbh > 10 & trees$dbh <=16 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`%	| 17-22”: `r round(sum(trees$stand == std & trees$dbh > 16 & trees$dbh <= 22 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`% |	23+”: `r round(sum(trees$stand == std & trees$dbh > 22 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`%  

> - __Standing dead wood:__    
\vspace{2pt}
`r round((plots %>% filter(stand == std) %>% summarize(snagba = mean(ba_snags)))$snagba[1])` ft^2^/acre; `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = mean(dbh)))$snagd[1])`\" mean dbh (ranging from `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = min(dbh)))$snagd[1])`\" to `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = max(dbh)))$snagd[1])`\")

##Inventory information

> - `r stands %>% filter(stand == std) %>% .$plots` points, `r baf` BAF, `r paste(lubridate::month(month, label = TRUE, abbr = FALSE), year, sep = ", ")`

```{r stockingchart5, fig.cap="Points represent individual plots. Asterisk represnts stand average. Radial lines are quadratic stand diameters.", echo=FALSE, results='hide'}
this_stand <- stands %>%
  filter(stand == std)

# qsd lines --------------

dbhbold <- seq(2, 26, 2)
dbhlight <- seq(1, 25, 2)

# qsd labels -------------

dbhlabs <- paste(c(4,6,8,10,12,14,16,20), '"', sep = "")

dbhlabstop <- tibble(y = rep(max(this_stand$ay1, 
                             max((plots %>% 
                                    filter(stand == std))$ba_live))+5, 
                             times = 8)) %>% 
  mutate(x = y/(.005454*c(4,6,8,10,12,14,16,20)^2))

dbhlabsright <- tibble(x = rep(max(this_stand$ax2,
                                   max((plots %>%
                                          filter(stand == std))$tpa_live))+50,
                               times = 8))
dbhlabsright <- dbhlabsright %>%
  mutate(y = x*.005454*c(4,6,8,10,12,14,16,20)^2)

# plot with a b & c curves -----------

curveplot <- plots %>% filter(stand == std) %>%
  ggplot(aes(tpa_live, ba_live)) +
  geom_abline(slope = .005454*dbhbold^2, col = "dark gray") +
  geom_abline(slope = .005454*dbhlight^2, col = "gray") +
  annotate("text", x = dbhlabstop$x, 
           y = dbhlabstop$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  annotate("text", x = dbhlabsright$x, 
           y = dbhlabsright$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  geom_curve(aes(x = this_stand$ax1,
                 y = this_stand$ay1,
                 xend = this_stand$ax2,
                 yend = this_stand$ay2),
             curvature = this_stand$acurv,
             angle = this_stand$aangle) + 
  geom_curve(aes(x = this_stand$bx1,
                 y = this_stand$by1,
                 xend = this_stand$bx2,
                 yend = this_stand$by2),
             curvature = this_stand$bcurv,
             angle = this_stand$bangle) + 
  geom_curve(aes(x = this_stand$cx1,
                 y = this_stand$cy1,
                 xend = this_stand$cx2,
                 yend = this_stand$cy2),
             curvature = this_stand$ccurv,
             angle = this_stand$cangle) +
  geom_text(aes(this_stand$ax2, 
                this_stand$ay2, 
                label = this_stand$alab),
            nudge_x = this_stand$anudge,
            family = "Perpetua") +
  geom_text(aes(this_stand$bx2, 
                this_stand$by2, 
                label = this_stand$blab),
            nudge_x = this_stand$bnudge,
            family = "Perpetua") +
  geom_text(aes(this_stand$cx2, 
                this_stand$cy2, 
                label = this_stand$clab),
            nudge_x = this_stand$cnudge,
            family = "Perpetua") +
  geom_point() +
  geom_point(aes(this_stand$tpa, 
                 this_stand$mean_ba),
             size = 3, 
             shape = 8, 
             stroke = 1.5) +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "right") +
  scale_x_continuous(name = "trees per acre",
                     limits = c(min(this_stand$cx1, 
                                    min((plots %>% 
                                           filter(stand == std))$tpa_live)),
                                max(this_stand$ax2,
                                    max((plots %>% 
                                           filter(stand == std))$tpa_live))+50)) +
  scale_y_continuous(name = "basal area per acre (sq ft)",
                     limits = c(min(this_stand$cy2, 
                                    min((plots %>% 
                                           filter(stand == std))$ba_live)),
                                max(this_stand$ay1,
                                    max((plots %>% 
                                           filter(stand == std))$ba_live))+5)) +
  labs(title = "Stocking chart",
       caption = paste("Reproduced from ", this_stand$name, 
                       " stocking guide: ", this_stand$author,
                       ". ", this_stand$source, sep = ""))

# plot w/o curves -----------------

dbhlabstop <- tibble(y = rep(max((plots %>% 
                                    filter(stand == std))$ba_live)+20, 
                             times = 8)) %>% 
  mutate(x = y/(.005454*c(4,6,8,10,12,14,16,20)^2))

dbhlabsright <- tibble(x = rep(max((plots %>%
                                          filter(stand == std))$tpa_live)+100,
                               times = 8)) %>%
  mutate(y = x*.005454*c(4,6,8,10,12,14,16,20)^2)
  
curvelessplot <- plots %>% filter(stand == std) %>%
  ggplot(aes(tpa_live, ba_live)) +
  geom_abline(slope = .005454*dbhbold^2, col = "dark gray") +
  geom_abline(slope = .005454*dbhlight^2, col = "gray") +
  annotate("text", x = dbhlabstop$x, 
           y = dbhlabstop$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  annotate("text", x = dbhlabsright$x, 
           y = dbhlabsright$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  geom_point() +
  geom_point(aes(this_stand$tpa, 
                 this_stand$mean_ba),
             size = 3, 
             shape = 8, 
             stroke = 1.5) +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "right") +
  scale_x_continuous(name = "trees per acre",
                     limits = c(min((plots %>% 
                                           filter(stand == std))$tpa_live)-100,
                                max((plots %>% 
                                           filter(stand == std))$tpa_live)+100)) +
  scale_y_continuous(name = "basal area per acre (sq ft)",
                     limits = c(min((plots %>% 
                                           filter(stand == std))$ba_live)-20,
                                max((plots %>% 
                                           filter(stand == std))$ba_live)+20)) +
  labs(title = "Stocking chart")

ifelse(this_stand$structure.1[1] == "Even-aged", print(curveplot),
       print(curvelessplot))
```

```{r ags_ugs_table5, results="asis"}
temp1 <- stands %>% filter(stand == std)
temp2 <- c(temp1$mean_ba, temp1$qsd, temp1$tpa)
temp3 <- c(temp1$ba_ags, temp1$qsd_ags, temp1$tpa_ags)
temp4 <- c(temp1$ba_inv, temp1$qsd_in, temp1$tpa_inv)
temp0 <- c('Basal area (sqft/ac)', 'QSD (in)', 'Stems/ac')
temp5 <- data.frame(temp0, temp2, temp3, temp4)

kable(temp5, digits = 0, col.names = c(' ', 'Total', 'Acceptable', 'Investment-grade'), caption = "Measures of stocking for all live trees (total), acceptable growing stock, and investment-grade growing stock (which is a subset of acceptable growing stock).")
```

\newpage
##Long-term management system

**Hybrid selection system**^[Nyland, R.D. 2002. Silviculture: Concepts and Applications. 2nd edition. Waveland Press Inc., Long Grove, IL. p. 248;  Leak, W.B., M.Yamasaki, and R. Holleran. 2014. Silvicultural Guide for Northern Hardwoods in the Northeast. USDA For. Serv. Gen. Tech. Rep. NRS-132.]   

The vertical structure that is already present in the stand should be encouraged and enhanced by converting to an uneven-aged system, where trees of many ages are grown in close proximity.  The structure can largely follow that of a typical single tree selection system, with trees of different ages locally intermixed, but canopy openings may exceed the 1/10 acre upper limit called for in single tree selection systems, or, more often, larger, low density patches and edges may be used to create growth environments that foster greater diversity. 

Eventually, we will create a structure in which roughly 30% of the basal area is poles, 30% is small sawtimber, and 40% is large and very large sawtimber.  Logging will take place about every 20 years, reducing the overstory stocking to some 70 square feet per acre.  In each entry mature crop trees will be harvested, immature trees will be tended to focus growth on the best stems, and new regeneration will be initiated or released.  This system will allow for the efficient establishment of new regeneration while maximizing the stocking of desirable trees that are carried to the end of their rotation.  Target diameters for crop trees will be specific to individual species as follows: 24 inches for white pine, sugar maple, yellow birch, and black cherry; 18 inches for other commercial hardwoods (with exceptions allowed for all veneer quality hardwood stems); 18 inches for hemlock; and 14 inches for fir.  

Some exceptionally old and large stems should be retained for their value to wildlife and contribution to structural complexity in the stand as well. In the near and medium terms, all of the existing old pasture trees should be kept, and down woody material from windthrow should be left on the ground.

##Silvicultural prescription

The stocking is currently quite low, and no logging should happen over the next decade. Minimal efforts to control invasive plants now (by hand pulling) could have large returns later when regeneration is desired. The owners may wish to cut firewood for their own use. Removals should be limited to a handful of cords per year from unacceptable growing stock.  
\newpage

```{r set6}
std <- 6
```

#Area `r std` 
`r (stands %>% filter(stand == std))$type`    
\noindent `r sprintf("%.2f", (stands %>% filter(stand == std))$acres_legal)` legal acres | `r sprintf("%.2f", (stands %>% filter(stand == std))$acres_calc)` measured acres    

##Site-specific information

> - __Soils:__   
\indent\indent `r paste((soils %>% filter(stand == std))$text, collapse = " ") %>% str_replace_all("START", "\n") %>% str_replace_all("END", "  ")` 

> - __Site Class:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$site_class` (determined from soil mapping and field assessment)   

> - __Access:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$access` 

> - __Stand history:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$history` 

##Current forest information

> - __Age Class Structure:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$structure.1`  
```{r diam_dist6, fig.margin=TRUE, fig.width=2, fig.height=6, fig.cap="Distributions are approximated with kernel density estimation. Common species are those that account for at least 8 percent of the total stocking and areas under each curve represent species basal areas."}

# diameter dist of main spp in a specific stand ----

trees %>% filter(stand == std, live == 1, dbh >= 6) %>%
  group_by(spp) %>%
  mutate(spp_sum = sum(live)) %>%
  ungroup() %>%
  mutate(spp = reorder(spp, -live, FUN = sum)) %>%
  filter(spp_sum/n()>=.08) %>% 
  ggplot(aes(dbh, y = ..count..)) +
  geom_density(alpha = .6, position = "identity", fill = "grey", col = "dark grey") +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "none") +
  facet_wrap(~spp, ncol = 1) +
  scale_y_continuous("relative basal area", labels = NULL, 
                     breaks = NULL) +
  scale_x_continuous("dbh") +
  labs(title = "Diameter distributions", 
       subtitle = "for common species")
```

```{r spp6}
x <- trees %>% 
  filter(stand == std, live == 1, dbh >= 6) %>% 
  group_by(spp) %>% 
  summarize(spp_sum = sum(live)) %>%
  mutate(pct = spp_sum / sum(spp_sum)) %>%
  select(spp, pct) %>%
  arrange(-pct)
```

> - __Species (% stocking):__   
\vspace{2pt}
`r if_else(nrow(x)>0, paste(x$spp, " (", round(x$pct*100), '%)', sep = '', collapse = ", "), "none")`  

> - __Regeneration:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$regen`  

> - __Forest health:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$health`  

> - __Volume/ac:__   
\vspace{2pt}
`r round(stands %>% filter(stand == std) %>% .$veneer_vol/1000,1)` MBF veneer, `r round(stands %>% filter(stand == std) %>% .$saw_vol/1000,1)` MBF sawtimber, `r round(stands %>% filter(stand == std) %>% .$tie_vol/1000,1)` MBF tie logs,   
`r round(stands %>% filter(stand == std) %>% .$cord_vol)` cds pulp   

> - __Size class structure (%BA):__  	 
\vspace{2pt}
\indent 6-10”: `r round(sum(trees$stand == std & trees$dbh >= 6 & trees$dbh <= 10 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`% | 11-16”: `r round(sum(trees$stand == std & trees$dbh > 10 & trees$dbh <=16 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`%	| 17-22”: `r round(sum(trees$stand == std & trees$dbh > 16 & trees$dbh <= 22 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`% |	23+”: `r round(sum(trees$stand == std & trees$dbh > 22 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`%  

> - __Standing dead wood:__    
\vspace{2pt}
`r round((plots %>% filter(stand == std) %>% summarize(snagba = mean(ba_snags)))$snagba[1])` ft^2^/acre; `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = mean(dbh)))$snagd[1])`\" mean dbh (ranging from `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = min(dbh)))$snagd[1])`\" to `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = max(dbh)))$snagd[1])`\")

##Inventory information

> - `r stands %>% filter(stand == std) %>% .$plots` points, `r baf` BAF, `r paste(lubridate::month(month, label = TRUE, abbr = FALSE), year, sep = ", ")`

```{r stockingchart6, fig.cap="Points represent individual plots. Asterisk represnts stand average. Radial lines are quadratic stand diameters.", echo=FALSE, results='hide'}
this_stand <- stands %>%
  filter(stand == std)

# qsd lines --------------

dbhbold <- seq(2, 26, 2)
dbhlight <- seq(1, 25, 2)

# qsd labels -------------

dbhlabs <- paste(c(4,6,8,10,12,14,16,20), '"', sep = "")

dbhlabstop <- tibble(y = rep(max(this_stand$ay1, 
                             max((plots %>% 
                                    filter(stand == std))$ba_live))+5, 
                             times = 8)) %>% 
  mutate(x = y/(.005454*c(4,6,8,10,12,14,16,20)^2))

dbhlabsright <- tibble(x = rep(max(this_stand$ax2,
                                   max((plots %>%
                                          filter(stand == std))$tpa_live))+50,
                               times = 8))
dbhlabsright <- dbhlabsright %>%
  mutate(y = x*.005454*c(4,6,8,10,12,14,16,20)^2)

# plot with a b & c curves -----------

curveplot <- plots %>% filter(stand == std) %>%
  ggplot(aes(tpa_live, ba_live)) +
  geom_abline(slope = .005454*dbhbold^2, col = "dark gray") +
  geom_abline(slope = .005454*dbhlight^2, col = "gray") +
  annotate("text", x = dbhlabstop$x, 
           y = dbhlabstop$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  annotate("text", x = dbhlabsright$x, 
           y = dbhlabsright$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  geom_curve(aes(x = this_stand$ax1,
                 y = this_stand$ay1,
                 xend = this_stand$ax2,
                 yend = this_stand$ay2),
             curvature = this_stand$acurv,
             angle = this_stand$aangle) + 
  geom_curve(aes(x = this_stand$bx1,
                 y = this_stand$by1,
                 xend = this_stand$bx2,
                 yend = this_stand$by2),
             curvature = this_stand$bcurv,
             angle = this_stand$bangle) + 
  geom_curve(aes(x = this_stand$cx1,
                 y = this_stand$cy1,
                 xend = this_stand$cx2,
                 yend = this_stand$cy2),
             curvature = this_stand$ccurv,
             angle = this_stand$cangle) +
  geom_text(aes(this_stand$ax2, 
                this_stand$ay2, 
                label = this_stand$alab),
            nudge_x = this_stand$anudge,
            family = "Perpetua") +
  geom_text(aes(this_stand$bx2, 
                this_stand$by2, 
                label = this_stand$blab),
            nudge_x = this_stand$bnudge,
            family = "Perpetua") +
  geom_text(aes(this_stand$cx2, 
                this_stand$cy2, 
                label = this_stand$clab),
            nudge_x = this_stand$cnudge,
            family = "Perpetua") +
  geom_point() +
  geom_point(aes(this_stand$tpa, 
                 this_stand$mean_ba),
             size = 3, 
             shape = 8, 
             stroke = 1.5) +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "right") +
  scale_x_continuous(name = "trees per acre",
                     limits = c(min(this_stand$cx1, 
                                    min((plots %>% 
                                           filter(stand == std))$tpa_live)),
                                max(this_stand$ax2,
                                    max((plots %>% 
                                           filter(stand == std))$tpa_live))+50)) +
  scale_y_continuous(name = "basal area per acre (sq ft)",
                     limits = c(min(this_stand$cy2, 
                                    min((plots %>% 
                                           filter(stand == std))$ba_live)),
                                max(this_stand$ay1,
                                    max((plots %>% 
                                           filter(stand == std))$ba_live))+5)) +
  labs(title = "Stocking chart",
       caption = paste("Reproduced from ", this_stand$name, 
                       " stocking guide: ", this_stand$author,
                       ". ", this_stand$source, sep = ""))

# plot w/o curves -----------------

dbhlabstop <- tibble(y = rep(max((plots %>% 
                                    filter(stand == std))$ba_live)+20, 
                             times = 8)) %>% 
  mutate(x = y/(.005454*c(4,6,8,10,12,14,16,20)^2))

dbhlabsright <- tibble(x = rep(max((plots %>%
                                          filter(stand == std))$tpa_live)+100,
                               times = 8)) %>%
  mutate(y = x*.005454*c(4,6,8,10,12,14,16,20)^2)
  
curvelessplot <- plots %>% filter(stand == std) %>%
  ggplot(aes(tpa_live, ba_live)) +
  geom_abline(slope = .005454*dbhbold^2, col = "dark gray") +
  geom_abline(slope = .005454*dbhlight^2, col = "gray") +
  annotate("text", x = dbhlabstop$x, 
           y = dbhlabstop$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  annotate("text", x = dbhlabsright$x, 
           y = dbhlabsright$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  geom_point() +
  geom_point(aes(this_stand$tpa, 
                 this_stand$mean_ba),
             size = 3, 
             shape = 8, 
             stroke = 1.5) +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "right") +
  scale_x_continuous(name = "trees per acre",
                     limits = c(min((plots %>% 
                                           filter(stand == std))$tpa_live)-100,
                                max((plots %>% 
                                           filter(stand == std))$tpa_live)+100)) +
  scale_y_continuous(name = "basal area per acre (sq ft)",
                     limits = c(min((plots %>% 
                                           filter(stand == std))$ba_live)-20,
                                max((plots %>% 
                                           filter(stand == std))$ba_live)+20)) +
  labs(title = "Stocking chart")

ifelse(this_stand$structure.1[1] == "Even-aged", print(curveplot),
       print(curvelessplot))
```

```{r ags_ugs_table6, results="asis"}
temp1 <- stands %>% filter(stand == std)
temp2 <- c(temp1$mean_ba, temp1$qsd, temp1$tpa)
temp3 <- c(temp1$ba_ags, temp1$qsd_ags, temp1$tpa_ags)
temp4 <- c(temp1$ba_inv, temp1$qsd_in, temp1$tpa_inv)
temp0 <- c('Basal area (sqft/ac)', 'QSD (in)', 'Stems/ac')
temp5 <- data.frame(temp0, temp2, temp3, temp4)

kable(temp5, digits = 0, col.names = c(' ', 'Total', 'Acceptable', 'Investment-grade'), caption = "Measures of stocking for all live trees (total), acceptable growing stock, and investment-grade growing stock (which is a subset of acceptable growing stock).")
```

##Long-term management system

**Even-aged management**^[Gilmore, D.W. and B.J. Palik. 2005. A Revised Managers Handbook for Red Pine in the North Central Region. USDA For. Serv. Gen. Tech. Rep. NC-264.]      
This area should be maintained as an even-aged stand and grown to an age of about 90 before it is regenerated (we believe it's about 70 now). Regular tending, every 20 years or so, should focus growth on the highest quality stems. The site is well suited to northern hardwood species, and we don't expect red pine to carry over into the next rotation, except that a few should be kept as biological legacies. 

\newpage
##Silvicultural prescription

**Thinning from below**^[Gilmore, D.W. and B.J. Palik. 2005. A Revised Managers Handbook for Red Pine in the North Central Region. USDA For. Serv. Gen. Tech. Rep. NC-264.]   
\noindent __Year:__ 2022 

The stand is currently overstocked and in danger of rapidly declining. a Light thinning from below should be carried out to encourage canopy development without triggering windthrow. No more than about 1/3^rd^ of the stocking should be removed, leaving a residual basal area of 170 ft^2^/acre or thereabouts. The most vigorous trees with the largest live crowns should be retained, and suppressed and intermediate trees should be cut. 

\newpage

```{r set7}
std <- 7
```

#Area `r std` 
`r (stands %>% filter(stand == std))$type`    
\noindent `r sprintf("%.2f", (stands %>% filter(stand == std))$acres_legal)` legal acres | `r sprintf("%.2f", (stands %>% filter(stand == std))$acres_calc)` measured acres    

##Site-specific information

> - __Soils:__   
\indent\indent `r paste((soils %>% filter(stand == std))$text, collapse = " ") %>% str_replace_all("START", "\n") %>% str_replace_all("END", "  ")` 

> - __Site Class:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$site_class` (determined from soil mapping and field assessment)   

> - __Access:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$access` 

> - __Stand history:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$history` 

##Current forest information

> - __Age Class Structure:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$structure.1`  
```{r diam_dist7, fig.margin=TRUE, fig.width=2, fig.height=6, fig.cap="Distributions are approximated with kernel density estimation. Common species are those that account for at least 8 percent of the total stocking and areas under each curve represent species basal areas."}

# diameter dist of main spp in a specific stand ----

trees %>% filter(stand == std, live == 1, dbh >= 6) %>%
  group_by(spp) %>%
  mutate(spp_sum = sum(live)) %>%
  ungroup() %>%
  mutate(spp = reorder(spp, -live, FUN = sum)) %>%
  filter(spp_sum/n()>=.08) %>% 
  ggplot(aes(dbh, y = ..count..)) +
  geom_density(alpha = .6, position = "identity", fill = "grey", col = "dark grey") +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "none") +
  facet_wrap(~spp, ncol = 1) +
  scale_y_continuous("relative basal area", labels = NULL, 
                     breaks = NULL) +
  scale_x_continuous("dbh") +
  labs(title = "Diameter distributions", 
       subtitle = "for common species")
```

```{r spp7}
x <- trees %>% 
  filter(stand == std, live == 1, dbh >= 6) %>% 
  group_by(spp) %>% 
  summarize(spp_sum = sum(live)) %>%
  mutate(pct = spp_sum / sum(spp_sum)) %>%
  select(spp, pct) %>%
  arrange(-pct)
```

> - __Species (% stocking):__   
\vspace{2pt}
`r if_else(nrow(x)>0, paste(x$spp, " (", round(x$pct*100), '%)', sep = '', collapse = ", "), "none")`  

> - __Regeneration:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$regen`  

> - __Forest health:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$health`  

> - __Volume/ac:__   
\vspace{2pt}
`r round(stands %>% filter(stand == std) %>% .$veneer_vol/1000,1)` MBF veneer, `r round(stands %>% filter(stand == std) %>% .$saw_vol/1000,1)` MBF sawtimber, `r round(stands %>% filter(stand == std) %>% .$tie_vol/1000,1)` MBF tie logs,   
`r round(stands %>% filter(stand == std) %>% .$cord_vol)` cds pulp   

> - __Size class structure (%BA):__  	 
\vspace{2pt}
\indent 6-10”: `r round(sum(trees$stand == std & trees$dbh >= 6 & trees$dbh <= 10 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`% | 11-16”: `r round(sum(trees$stand == std & trees$dbh > 10 & trees$dbh <=16 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`%	| 17-22”: `r round(sum(trees$stand == std & trees$dbh > 16 & trees$dbh <= 22 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`% |	23+”: `r round(sum(trees$stand == std & trees$dbh > 22 & trees$live == 1)/sum(trees$stand == std & trees$dbh >= 6 & trees$live == 1)*100)`%  

> - __Standing dead wood:__    
\vspace{2pt}
`r round((plots %>% filter(stand == std) %>% summarize(snagba = mean(ba_snags)))$snagba[1])` ft^2^/acre; `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = mean(dbh)))$snagd[1])`\" mean dbh (ranging from `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = min(dbh)))$snagd[1])`\" to `r round((trees %>% filter(stand == std, live == 0) %>% summarize(snagd = max(dbh)))$snagd[1])`\")

##Inventory information

> - `r stands %>% filter(stand == std) %>% .$plots` points, `r baf` BAF, `r paste(lubridate::month(month, label = TRUE, abbr = FALSE), year, sep = ", ")`

```{r stockingchart7, fig.cap="Points represent individual plots. Asterisk represnts stand average. Radial lines are quadratic stand diameters.", echo=FALSE, results='hide'}
this_stand <- stands %>%
  filter(stand == std)

# qsd lines --------------

dbhbold <- seq(2, 26, 2)
dbhlight <- seq(1, 25, 2)

# qsd labels -------------

dbhlabs <- paste(c(4,6,8,10,12,14,16,20), '"', sep = "")

dbhlabstop <- tibble(y = rep(max(this_stand$ay1, 
                             max((plots %>% 
                                    filter(stand == std))$ba_live))+5, 
                             times = 8)) %>% 
  mutate(x = y/(.005454*c(4,6,8,10,12,14,16,20)^2))

dbhlabsright <- tibble(x = rep(max(this_stand$ax2,
                                   max((plots %>%
                                          filter(stand == std))$tpa_live))+50,
                               times = 8))
dbhlabsright <- dbhlabsright %>%
  mutate(y = x*.005454*c(4,6,8,10,12,14,16,20)^2)

# plot with a b & c curves -----------

curveplot <- plots %>% filter(stand == std) %>%
  ggplot(aes(tpa_live, ba_live)) +
  geom_abline(slope = .005454*dbhbold^2, col = "dark gray") +
  geom_abline(slope = .005454*dbhlight^2, col = "gray") +
  annotate("text", x = dbhlabstop$x, 
           y = dbhlabstop$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  annotate("text", x = dbhlabsright$x, 
           y = dbhlabsright$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  geom_curve(aes(x = this_stand$ax1,
                 y = this_stand$ay1,
                 xend = this_stand$ax2,
                 yend = this_stand$ay2),
             curvature = this_stand$acurv,
             angle = this_stand$aangle) + 
  geom_curve(aes(x = this_stand$bx1,
                 y = this_stand$by1,
                 xend = this_stand$bx2,
                 yend = this_stand$by2),
             curvature = this_stand$bcurv,
             angle = this_stand$bangle) + 
  geom_curve(aes(x = this_stand$cx1,
                 y = this_stand$cy1,
                 xend = this_stand$cx2,
                 yend = this_stand$cy2),
             curvature = this_stand$ccurv,
             angle = this_stand$cangle) +
  geom_text(aes(this_stand$ax2, 
                this_stand$ay2, 
                label = this_stand$alab),
            nudge_x = this_stand$anudge,
            family = "Perpetua") +
  geom_text(aes(this_stand$bx2, 
                this_stand$by2, 
                label = this_stand$blab),
            nudge_x = this_stand$bnudge,
            family = "Perpetua") +
  geom_text(aes(this_stand$cx2, 
                this_stand$cy2, 
                label = this_stand$clab),
            nudge_x = this_stand$cnudge,
            family = "Perpetua") +
  geom_point() +
  geom_point(aes(this_stand$tpa, 
                 this_stand$mean_ba),
             size = 3, 
             shape = 8, 
             stroke = 1.5) +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "right") +
  scale_x_continuous(name = "trees per acre",
                     limits = c(min(this_stand$cx1, 
                                    min((plots %>% 
                                           filter(stand == std))$tpa_live)),
                                max(this_stand$ax2,
                                    max((plots %>% 
                                           filter(stand == std))$tpa_live))+50)) +
  scale_y_continuous(name = "basal area per acre (sq ft)",
                     limits = c(min(this_stand$cy2, 
                                    min((plots %>% 
                                           filter(stand == std))$ba_live)),
                                max(this_stand$ay1,
                                    max((plots %>% 
                                           filter(stand == std))$ba_live))+5)) +
  labs(title = "Stocking chart",
       caption = paste("Reproduced from ", this_stand$name, 
                       " stocking guide: ", this_stand$author,
                       ". ", this_stand$source, sep = ""))

# plot w/o curves -----------------

dbhlabstop <- tibble(y = rep(max((plots %>% 
                                    filter(stand == std))$ba_live)+20, 
                             times = 8)) %>% 
  mutate(x = y/(.005454*c(4,6,8,10,12,14,16,20)^2))

dbhlabsright <- tibble(x = rep(max((plots %>%
                                          filter(stand == std))$tpa_live)+100,
                               times = 8)) %>%
  mutate(y = x*.005454*c(4,6,8,10,12,14,16,20)^2)
  
curvelessplot <- plots %>% filter(stand == std) %>%
  ggplot(aes(tpa_live, ba_live)) +
  geom_abline(slope = .005454*dbhbold^2, col = "dark gray") +
  geom_abline(slope = .005454*dbhlight^2, col = "gray") +
  annotate("text", x = dbhlabstop$x, 
           y = dbhlabstop$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  annotate("text", x = dbhlabsright$x, 
           y = dbhlabsright$y, 
           label = dbhlabs,
           color = "gray55",
           family = "Perpetua") +
  geom_point() +
  geom_point(aes(this_stand$tpa, 
                 this_stand$mean_ba),
             size = 3, 
             shape = 8, 
             stroke = 1.5) +
  theme(text = element_text(family = "Perpetua"), 
        legend.position = "right") +
  scale_x_continuous(name = "trees per acre",
                     limits = c(min((plots %>% 
                                           filter(stand == std))$tpa_live)-100,
                                max((plots %>% 
                                           filter(stand == std))$tpa_live)+100)) +
  scale_y_continuous(name = "basal area per acre (sq ft)",
                     limits = c(min((plots %>% 
                                           filter(stand == std))$ba_live)-20,
                                max((plots %>% 
                                           filter(stand == std))$ba_live)+20)) +
  labs(title = "Stocking chart")

ifelse(this_stand$structure.1[1] == "Even-aged", print(curveplot),
       print(curvelessplot))
```

##Long-term management system

**Even-aged management**^[Leak, W.B., M.Yamasaki, and R. Holleran. 2014. Silvicultural Guide for Northern Hardwoods in the Northeast. USDA For. Serv. Gen. Tech. Rep. NRS-132.]      
This area should be maintained as an even-aged stand and grown to an age of about 120 before it is regenerated (we believe most trees are about 40 now). Regular tending, every 20 years or so, should commence once the young trees have reached commercial sizes. It should focus growth on the highest quality stems and favor desirable species; namely sugar maple, black cherry, and red maple. Most of the white pine has no prospects for timber value-growth and should be removed at the first entry. 

##Silvicultural prescription

No work needs to happen in this young stand over the next decade, but the owners may wish to remove some of the poorly formed pine.

```{r ags_ugs_table7, results="asis"}
temp1 <- stands %>% filter(stand == std)
temp2 <- c(temp1$mean_ba, temp1$qsd, temp1$tpa)
temp3 <- c(temp1$ba_ags, temp1$qsd_ags, temp1$tpa_ags)
temp4 <- c(temp1$ba_inv, temp1$qsd_in, temp1$tpa_inv)
temp0 <- c('Basal area (sqft/ac)', 'QSD (in)', 'Stems/ac')
temp5 <- data.frame(temp0, temp2, temp3, temp4)

kable(temp5, digits = 0, col.names = c(' ', 'Total', 'Acceptable', 'Investment-grade'), caption = "Measures of stocking for all live trees (total), acceptable growing stock, and investment-grade growing stock (which is a subset of acceptable growing stock).")
```

\newpage

```{r set8}
std <- 8
```

#Area `r std` 
Wetland complex    
\noindent `r sprintf("%.2f", (stands %>% filter(stand == std))$acres_legal)` legal acres | `r sprintf("%.2f", (stands %>% filter(stand == std))$acres_calc)` measured acres    

##Site-specific information

> - __Soils:__   
\indent\indent `r paste((soils %>% filter(stand == std))$text, collapse = " ") %>% str_replace_all("START", "\n") %>% str_replace_all("END", "  ")` 

> - __Site Class:__   
\vspace{2pt}
`r (stands %>% filter(stand == std))$site_class` (determined from soil mapping and field assessment)   

##Inventory information

> - Qualitative assessment

##Current area information
This wetland area includes two abandoned or partially abandoned beaver ponds (one that is drying out and becoming a beaver meadow) and a small marsh. All three areas are located on muck soils, and it is unlikely that the abandoned beaver ponds will ever become productive timberland. More likely they will be rediscovered and re-flooded by beavers once enough woody growth returns to support the animals. 

These wetlands provide good habitat in their own right--for many obligate wetland plants and animals--but are especially valuable as a component of the larger landscape. They probably "green up" earlier in the spring than other natural communities in the vicinity, and give many animals their first good meal of the year. They are also a source of water for many animals and a hunting ground for bats, flycatchers, swallows, and red-winged blackbirds.

##Management considerations

Machinery should generally be kept out of the area to protect the soft soils and prevent hydrologic disturbance. The area should be monitored for invasive plant species. If invasives become established and look like they might cause ecological damage, early treatment could provide a more economical means of dealing with them. 
